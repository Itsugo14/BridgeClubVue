<!DOCTYPE html>
<html lang="en">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta charset="UTF-8">
         <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
        <title>Opret bruger</title>
        <style>
            body {
            display: inline-block;
            padding: 10px;
            font-size: x-large;
            background-color: lightgreen;
            }
        </style>
    </head>
        <body>
            <div id="app">
                <h1>Dansk Bridgeforbund</h1>
                <h4>Opret Bruger</h4>
                <form @submit.prevent="addUser">
                    <p>Fornavn: <input type ="text" required v-model="firstName"></p>
                    <p>Efternavn: <input type ="text" required v-model="surName"></p>
                    <p>Email: <input type ="text" required v-model="email"></p>
                    <p>Telefon nummer: <input type ="text" required v-model="phoneNumber"></p>
                    <p>Adresse: <input type ="text" required v-model="address1"></p>
                    <p>Postnummer: <input type ="text" required v-model="postCode"></p>
                    <p>Adgangskode: <input type ="password" required v-model="password"></p>
                    <p>Bekræft adgangskode: <input type ="password" required v-model="confirmPassword"></p>
                    <p>Fødselsdato: <input type ="date" required v-model="dateOfBirth"></p>
                    <button type="submit">Opret bruger</button>
                    <p v-if="addMessage">{{ addMessage }}</p>
                </form>
                <div>
                    <a href="GetAll.html">Se brugere</a>
                </div>
                <div>
                    <a href="Index.html">Tilbage til forside</a>
                </div>
            </div>

            <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
            <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

            <script>
                const baseUrl = "https://bridgeclubapi-bvhue4gpaahmdjbs.northeurope-01.azurewebsites.net/api/MembersDb";
                Vue.createApp({
                    data() {
                        return {
                            firstName: "",
                            surName: "",
                            email: "",
                            phoneNumber: "",
                            address1: "",
                            postCode: "",
                            password: "",
                            confirmPassword: "",
                            dateOfBirth: "",
                            addMessage: ""
                        }
                    },
                    methods: {

                        async addUser() {
                            if (this.password !== this.confirmPassword) {
                                this.addMessage = "Adgangskoderne matcher ikke.";
                                return;
                            }
                            try {
                                const response = await axios.post(
                                    baseUrl,
                                    {
                                        firstName: this.firstName,
                                        surName: this.surName,
                                        email: this.email,
                                        phoneNumber: this.phoneNumber,
                                        address1: this.address1,
                                        postCode: this.postCode,
                                        password: this.password,
                                        dateOfBirth: this.dateOfBirth
                                    }
                                );
                                this.addMessage = `Bruger oprettet! (${response.status} ${response.statusText})`;
                            } catch (ex) {
                                this.addMessage = ex.message;
                            }
                        }
                    }
                }).mount("#app")
                
            </script>
        </body>
</html>