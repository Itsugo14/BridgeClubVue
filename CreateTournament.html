<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <title>Opret Turnering</title>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">Dansk Bridgeforbund</a>
            <div class="collapse navbar-collapse">
                <ul class="navbar-nav mr-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link" href="Index.html">Forside</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="GetAll.html">Medlemsliste</a>
                    </li>
                </ul>
                <ul class="navbar-nav ml-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link" href="CreateUser.html">Opret Bruger</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="Login.html">Login</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="container py-5">
        <h1 class="mb-4 text-center">Opret Turnering</h1>
        <div id="app">
            <form @submit.prevent="createTournament" class="mx-auto" style="max-width: 500px;">
                <div class="form-group mb-3">
                    <label for="TournamentName">Navn</label>
                    <input type="text" id="TournamentName" v-model="TournamentName" class="form-control" required>
                </div>
                <div class="form-group mb-3">
                    <label for="TournamentDescription">Beskrivelse</label>
                    <textarea id="TournamentDescription" v-model="TournamentDescription" class="form-control"></textarea>
                </div>
                <div class="form-group mb-3">
                    <label for="Location">Lokation</label>
                    <input type="text" id="Location" v-model="Location" class="form-control" required>
                </div>
                <div class="form-group mb-3">
                    <label for="TournamentFormat">Format</label>
                    <select id="TournamentFormat" v-model="TournamentFormat" class="form-control" required>
                        <option value="">Vælg format</option>
                        <option v-for="f in formats" :key="f.FormatID" :value="f.Name">{{ f.Name }}</option>
                    </select>
                </div>
                <div class="form-group mb-3">
                    <label>Dage</label>
                    <div v-for="(date, idx) in DayList" :key="idx" class="input-group mb-2">
                        <input type="date" v-model="DayList[idx]" class="form-control" required>
                        <div class="input-group-append">
                            <button type="button" class="btn btn-danger" @click="removeDay(idx)" v-if="DayList.length > 1">&times;</button>
                        </div>
                    </div>
                    <button type="button" class="btn btn-secondary btn-sm" @click="addDay">Tilføj dag</button>
                </div>
                <button type="submit" class="btn btn-success w-100">Opret turnering</button>
                <p v-if="message" class="mt-3 text-center">{{ message }}</p>
            </form>
        </div>
    </div>
    <footer class="footer mt-auto py-3 bg-light">
        <div class="container text-center">
            <span class="text-muted">&copy; 2025 Dansk Bridgeforbund. Alle rettigheder forbeholdes.</span>
        </div>
    </footer>
    <script>
        // Opdater denne URL til din turnerings-API endpoint
        const tournamentUrl = "Indsæt_Tournament_API_URL_her";
        const formatUrl = "https://bridgeclubapi-bvhue4gpaahmdjbs.northeurope-01.azurewebsites.net/api/ClubTournamentsDb";
        Vue.createApp({
            data() {
                return {
                    TournamentName: "",
                    TournamentDescription: "",
                    Location: "",
                    TournamentFormat: "",
                    formats: [],
                    DayList: [""],
                    message: ""
                }
            },
            async mounted() {
                // Fetch formats from API
                try {
                    const response = await axios.get(formatUrl);
                    this.formats = response.data;
                } catch (ex) {
                    this.message = "Kunne ikke hente formater.";
                }
            },
            methods: {
                addDay() {
                    this.DayList.push("");
                },
                removeDay(idx) {
                    this.DayList.splice(idx, 1);
                },
                async createTournament() {
                    try {
                        const payload = {
                            Action: 'Add',
                            TournamentName: this.TournamentName,
                            TournamentDescription: this.TournamentDescription,
                            Location: this.Location,
                            FormatName: this.TournamentFormat,
                            IsActive: true,
                            DayList: this.DayList.filter(Boolean).join(",")
                        };
                        // const response = await axios.post(tournamentUrl, payload);
                        // this.message = `Turnering oprettet! (${response.status} ${response.statusText})`;
                        this.message = 'Turnering oprettet! (mock)';
                    } catch (ex) {
                        this.message = ex.message;
                    }
                }
            }
        }).mount("#app");
    </script>
</body>
</html>
